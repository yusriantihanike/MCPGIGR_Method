---
title: "MCPGIGR – Full Reproducible Analysis"
author: "Yusrianti Hanike"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output:
  html_document:
    theme: flatly
    toc: true
    toc_float: true
    code_folding: hide
    highlight: tango
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo    = TRUE,
  warning = FALSE,
  message = FALSE
)

library(knitr)
library(kableExtra)
library(magrittr)
```

<style>
body { font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif; font-size: 15px; }
h1.title { color: #005b96; font-weight: 700; }
h2 { color: #0083b0; border-bottom: 2px solid #e0e0e0; padding-bottom: 4px; }
h3 { color: #00a8a8; }
.table caption { caption-side: top; font-weight: bold; font-size: 0.95rem; color: #555; }
code { background-color: #f8f8f8; padding: 2px 4px; border-radius: 4px; }
</style>


## 1. Install Packages

Before running the MCPGIGR analysis, several R packages must be installed and loaded to ensure that all functions required for optimisation, distribution evaluation, and data handling are available.  
The code below shows the core packages used in this implementation.

```{r install-display, eval=FALSE}
# Core packages required for the MCPGIGR implementation
library("gmp")
library("Rmpfr")
library("MASS")
library("MixedPoisson")
library("gamlss")
library("Bessel")
library("maxLik")
library("COUNT")
library("readxl")
```

To keep the main scripts clean, the actual installation and loading of these packages are handled in a separate script:



```{r run-install, echo=FALSE}
source("Install Packages.R")
```

## 2. Input Data and Descriptive Statistics

The empirical data are available at:  
https://dinkes.jatimprov.go.id/index.php?r=site/file_list&id_file=10&id_berita=8


Below is the summary of the outcome variables \(Y_1\) and \(Y_2\), as well as the predictor variables \(X_1\)–\(X_6\).

```{r show-data-code, eval=FALSE}
source("Input Data.R")
source("Descriptive Data.R")
```
```{r run-data-desc, echo=FALSE}
source("Input Data.R")
source("Descriptive Data.R")
```

### 2.1 Outcome variables (Y1, Y2)

```{r desc-y}
summary_y %>%
  round(3) %>%
  kable(caption = "Summary of outcome variables (Y1 and Y2).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 2.2 Predictor variables (X1–X6)

```{r desc-x}
summary_x %>%
  round(3) %>%
  kable(caption = "Summary of predictor variables (X1–X6).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

## 3. Initial Values

The initial values are obtained from Poisson regression and then used as starting values for the MCPGIGR estimation.
```{r show-init, eval=FALSE}
# Script for generating initial parameter values
source("Initial Value.R")
```

```{r run-init, echo=FALSE}
source("Initial Value.R")
```

### 3.1 Initial regression coefficients

```{r init-beta}
beta_table %>%
  round(6) %>%
  kable(caption = "Initial Poisson-based regression coefficients (beta_0–beta_6) for Y1 and Y2.") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 3.2 Initial dispersion / mixing parameters

```{r init-disp}
disp_table$Initial <- round(disp_table$Initial, 6)
disp_table %>%
  kable(caption = "Initial values for dispersion / mixing parameters (tau and psi).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

## 4. Parameter Estimates (MCPGIGR)

Parameter estimation is carried out using maximum likelihood with the BHHH algorithm.

```{r show-estimate, eval=FALSE}
# Scripts for MCPGIGR parameter estimation using MLE + BHHH
source("LnLikelihood.R")
source("Gradient.R")
source("Model Estimate.R")
source("Parameter Result.R")
```

```{r run-estimate, echo=FALSE}
source("LnLikelihood.R")
source("Gradient.R")
source("Model Estimate.R")
source("Parameter Result.R")
```

### 4.1 Regression coefficients

```{r est-beta}
param_table %>%
  round(6) %>%
  kable(caption = "MCPGIGR regression coefficient estimates for Y1 and Y2 (beta_0–beta_6).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 4.2 Dispersion / mixing parameters

```{r est-disp}
disp_table_hat$Estimate <- round(disp_table_hat$Estimate, 6)
disp_table_hat %>%
  kable(caption = "Estimated dispersion / mixing parameters (psi and tau).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

## 5. Hypothesis Testing (Z-tests and Likelihood Ratio Test)

Hypothesis testing is based on the likelihood ratio test for the global model comparison and Z-tests for individual parameters.

```{r show-hypo, eval=FALSE}
# Script for Z-tests and Likelihood Ratio Tests
source("Hypothesis Testing Result.R")
```


```{r run-hypo, echo=FALSE}
source("Hypothesis Testing Result.R")
```

### 5.1 Coefficients for Y1 (b01–b61)

```{r ztest-y1}
Y1_test %>%
  round(6) %>%
  kable(caption = "Z-tests for regression coefficients of Y1 (b01–b61).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 5.2 Coefficients for Y2 (b02–b62)

```{r ztest-y2}
Y2_test %>%
  round(6) %>%
  kable(caption = "Z-tests for regression coefficients of Y2 (b02–b62).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 5.3 Dispersion parameters (psi, tau)

```{r ztest-disp}
Dispersion_test %>%
  round(6) %>%
  kable(caption = "Z-tests for dispersion parameters (psi and tau).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

## 6. Reproducibility Notes

```{r repro-notes, echo=FALSE}
cat(
  "- All results above are generated using R version ", as.character(getRversion()), ".\n",
  "- The full MCPGIGR pipeline is implemented through modular scripts (e.g., ` Install Packages.R`, `Input Data.R`, `Initial Value.R`, and the likelihood/gradient/estimation scripts) in the project root and `R/` folder.\n",
  "- To reproduce this report:\n",
  "  1. Clone the GitHub repository.\n",
  "  2. Open `MCPGIGR_Method.Rproj` in RStudio.\n",
  "  3. Run the modular scripts (or this R Markdown file) in the same working directory.\n",
  "  4. Knit this file to HTML.\n",
  sep = ""
)
```
