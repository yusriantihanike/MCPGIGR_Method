---
title: "MCPGIGR – Full Reproducible Analysis"
author: "Yusrianti Hanike"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output:
  html_document:
    theme: flatly
    toc: true
    toc_float: true
    code_folding: hide
    highlight: tango
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo    = TRUE,
  warning = FALSE,
  message = FALSE
)

library(knitr)
library(kableExtra)
library(magrittr)
```

```{r style, echo=FALSE}
cat("
<style>
body { font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif; font-size: 15px; }
h1.title { color: #005b96; font-weight: 700; }
h2 { color: #0083b0; border-bottom: 2px solid #e0e0e0; padding-bottom: 4px; }
h3 { color: #00a8a8; }
.table caption { caption-side: top; font-weight: bold; font-size: 0.95rem; color: #555; }
code { background-color: #f8f8f8; padding: 2px 4px; border-radius: 4px; }
</style>
")
```

## 1. Run MCPGIGR Pipeline

```{r run, echo=FALSE}
source("Run Pipeline.R")
```

```{r split-partial, include=FALSE}
Y1_test         <- Partial.test[1:7, ]
Y2_test         <- Partial.test[8:14, ]
Dispersion_test <- Partial.test[15:16, ]
```

## 2. Descriptive Statistics

### 2.1 Outcome variables (Y1, Y2)

```{r desc-y}
summary_y %>%
  round(3) %>%
  kable(caption = "Summary of Outcome Variables (Y1 and Y2)") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 2.2 Predictor variables (X1–X6)

```{r desc-x}
summary_x %>%
  round(3) %>%
  kable(caption = "Summary of Predictor Variables (X1–X6)") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

## 3. Initial Values

### 3.1 Initial regression coefficients

```{r init-beta}
beta_table %>%
  round(6) %>%
  kable(caption = "Initial Poisson-based regression coefficients (beta_0–beta_6) for Y1 and Y2.") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 3.2 Initial dispersion / mixing parameters

```{r init-disp}
disp_table$Initial <- round(disp_table$Initial, 6)
disp_table %>%
  kable(caption = "Initial values for dispersion / mixing parameters (tau and psi).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

## 4. Parameter Estimates (MCPGIGR)

### 4.1 Regression coefficients

```{r est-beta}
param_table %>%
  round(6) %>%
  kable(caption = "MCPGIGR regression coefficient estimates for Y1 and Y2 (beta_0–beta_6).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 4.2 Dispersion / mixing parameters

```{r est-disp}
disp_table_hat$Estimate <- round(disp_table_hat$Estimate, 6)
disp_table_hat %>%
  kable(caption = "Estimated dispersion / mixing parameters (psi and tau).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

## 5. Hypothesis Testing (Z-tests)

### 5.1 Coefficients for Y1 (b01–b61)

```{r ztest-y1}
Y1_test %>%
  round(6) %>%
  kable(caption = "Z-tests for regression coefficients of Y1 (b01–b61).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 5.2 Coefficients for Y2 (b02–b62)

```{r ztest-y2}
Y2_test %>%
  round(6) %>%
  kable(caption = "Z-tests for regression coefficients of Y2 (b02–b62).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

### 5.3 Dispersion parameters (psi, tau)

```{r ztest-disp}
Dispersion_test %>%
  round(6) %>%
  kable(caption = "Z-tests for dispersion parameters (psi and tau).") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed"))
```

## 6. Reproducibility Notes

```{r repro-notes, echo=FALSE}
cat(
  "- All results above are generated using R version ", as.character(getRversion()), ".\n",
  "- The full pipeline is implemented in `Run Pipeline.R` and the modular scripts in the `R/` folder.\n",
  "- To reproduce this report:\n",
  "  1. Clone the GitHub repository.\n",
  "  2. Open `MCPGIGR_Method.Rproj` in RStudio.\n",
  "  3. Run: `source(\"Run Pipeline.R\")`.\n",
  "  4. Knit this file: `rmarkdown::render(\"MCPGIGR-Analysis.Rmd\")`.\n",
  sep = ""
)
```
